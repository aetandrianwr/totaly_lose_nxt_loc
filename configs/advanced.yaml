# Advanced v7 - Balanced between v4 and v6
model:
  name: "advanced"
  params:
    num_locations: 1187
    num_users: 46
    embedding_dim: 68  # Between 64 and 72
    num_clusters: 29  # Between 28 and 30
    num_heads: 4
    num_layers: 2
    dropout: 0.24  # Between 0.18 and 0.30
    use_val_prior: true

training:
  batch_size: 64
  num_epochs: 450
  learning_rate: 0.0030
  weight_decay: 0.00015  # Between 0.00008 and 0.0003
  gradient_clip: 1.3
  early_stopping_patience: 80
  
  use_ema: true
  ema_decay: 0.998
  
  lr_scheduler: "cosine_warmup"
  warmup_epochs: 28
  
  use_temporal_jitter: true
  jitter_prob: 0.22

data:
  train_path: "data/geolife/geolife_transformer_7_train.pk"
  val_path: "data/geolife/geolife_transformer_7_validation.pk"
  test_path: "data/geolife/geolife_transformer_7_test.pk"
  max_seq_len: 60
  num_workers: 4
  val_strong_prior_path: "data/val_ultra_prior.pt"

optimizer:
  name: "adamw"
  betas: [0.9, 0.98]
  eps: 1.0e-8

loss:
  label_smoothing: 0.10

system:
  seed: 42
  device: "cuda"
  checkpoint_dir: "checkpoints"
  log_dir: "logs"

logging:
  use_tensorboard: false
  print_freq: 50


# Optimizer
optimizer:
  name: "adamw"
  betas: [0.9, 0.98]
  eps: 1.0e-8

# Loss
loss:
  label_smoothing: 0.05
  
# Regularization
regularization:
  dropout: 0.15
  weight_decay: 0.0001

# System
system:
  seed: 42
  device: "cuda"
  checkpoint_dir: "checkpoints"
  log_dir: "logs"
  save_freq: 5
  
# Logging
logging:
  use_tensorboard: true
  print_freq: 50
